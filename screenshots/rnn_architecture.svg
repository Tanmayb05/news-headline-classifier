<svg viewBox="0 0 800 900" xmlns="http://www.w3.org/2000/svg">
  <!-- Title -->
  <text x="400" y="30" font-size="24" font-weight="bold" text-anchor="middle" fill="#333">
    LSTM-RNN Architecture for Text Classification
  </text>
  
  <!-- Input Layer -->
  <rect x="300" y="70" width="200" height="60" fill="#E3F2FD" stroke="#1976D2" stroke-width="2" rx="5"/>
  <text x="400" y="95" font-size="14" font-weight="bold" text-anchor="middle" fill="#333">Input Text</text>
  <text x="400" y="115" font-size="12" text-anchor="middle" fill="#666">[seq_len, batch_size]</text>
  
  <!-- Arrow -->
  <path d="M 400 130 L 400 170" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Embedding Layer -->
  <rect x="250" y="170" width="300" height="80" fill="#FFF3E0" stroke="#F57C00" stroke-width="2" rx="5"/>
  <text x="400" y="195" font-size="14" font-weight="bold" text-anchor="middle" fill="#333">Embedding Layer</text>
  <text x="400" y="215" font-size="11" text-anchor="middle" fill="#666">vocab_size → embedding_dim (128)</text>
  <text x="400" y="235" font-size="12" text-anchor="middle" fill="#666">[seq_len, batch_size, 128]</text>
  
  <!-- Arrow -->
  <path d="M 400 250 L 400 290" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Packing Box -->
  <rect x="280" y="290" width="240" height="50" fill="#F3E5F5" stroke="#7B1FA2" stroke-width="2" rx="5" stroke-dasharray="5,5"/>
  <text x="400" y="310" font-size="12" font-weight="bold" text-anchor="middle" fill="#333">pack_padded_sequence</text>
  <text x="400" y="328" font-size="10" text-anchor="middle" fill="#666">(handles variable lengths)</text>
  
  <!-- Arrow -->
  <path d="M 400 340 L 400 380" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- LSTM Layer -->
  <rect x="200" y="380" width="400" height="180" fill="#E8F5E9" stroke="#388E3C" stroke-width="3" rx="5"/>
  <text x="400" y="405" font-size="16" font-weight="bold" text-anchor="middle" fill="#333">LSTM Layer</text>
  <text x="400" y="425" font-size="12" text-anchor="middle" fill="#666">embedding_dim (128) → hidden_dim (256)</text>
  
  <!-- LSTM Internal Components -->
  <g transform="translate(220, 440)">
    <!-- Cell State -->
    <rect x="0" y="0" width="100" height="40" fill="#C8E6C9" stroke="#2E7D32" stroke-width="1.5" rx="3"/>
    <text x="50" y="25" font-size="11" text-anchor="middle" fill="#333">Cell State (c)</text>
    
    <!-- Hidden State -->
    <rect x="130" y="0" width="100" height="40" fill="#C8E6C9" stroke="#2E7D32" stroke-width="1.5" rx="3"/>
    <text x="180" y="25" font-size="11" text-anchor="middle" fill="#333">Hidden State (h)</text>
    
    <!-- Gates -->
    <ellipse cx="50" cy="70" rx="30" ry="20" fill="#A5D6A7" stroke="#2E7D32" stroke-width="1"/>
    <text x="50" y="75" font-size="9" text-anchor="middle" fill="#333">Forget</text>
    
    <ellipse cx="120" cy="70" rx="30" ry="20" fill="#A5D6A7" stroke="#2E7D32" stroke-width="1"/>
    <text x="120" y="75" font-size="9" text-anchor="middle" fill="#333">Input</text>
    
    <ellipse cx="190" cy="70" rx="30" ry="20" fill="#A5D6A7" stroke="#2E7D32" stroke-width="1"/>
    <text x="190" y="75" font-size="9" text-anchor="middle" fill="#333">Output</text>
  </g>
  
  <text x="400" y="545" font-size="11" text-anchor="middle" fill="#666">Output: [seq_len, batch_size, 256]</text>
  
  <!-- Arrow -->
  <path d="M 400 560 L 400 600" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Hidden State Extraction -->
  <rect x="280" y="600" width="240" height="60" fill="#FCE4EC" stroke="#C2185B" stroke-width="2" rx="5"/>
  <text x="400" y="622" font-size="13" font-weight="bold" text-anchor="middle" fill="#333">Extract Last Hidden State</text>
  <text x="400" y="640" font-size="11" text-anchor="middle" fill="#666">hidden.squeeze(0)</text>
  <text x="400" y="655" font-size="11" text-anchor="middle" fill="#666">[batch_size, 256]</text>
  
  <!-- Arrow -->
  <path d="M 400 660 L 400 700" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Fully Connected Layer -->
  <rect x="250" y="700" width="300" height="80" fill="#FFEBEE" stroke="#D32F2F" stroke-width="2" rx="5"/>
  <text x="400" y="725" font-size="14" font-weight="bold" text-anchor="middle" fill="#333">Fully Connected Layer</text>
  <text x="400" y="745" font-size="11" text-anchor="middle" fill="#666">hidden_dim (256) → output_dim (4)</text>
  <text x="400" y="765" font-size="12" text-anchor="middle" fill="#666">[batch_size, 4]</text>
  
  <!-- Arrow -->
  <path d="M 400 780 L 400 820" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Output Layer -->
  <rect x="300" y="820" width="200" height="60" fill="#E1F5FE" stroke="#0288D1" stroke-width="2" rx="5"/>
  <text x="400" y="845" font-size="14" font-weight="bold" text-anchor="middle" fill="#333">Output (Logits)</text>
  <text x="400" y="865" font-size="12" text-anchor="middle" fill="#666">4 Classes (b, t, e, m)</text>
  
  <!-- Model Parameters Box -->
  <rect x="20" y="100" width="180" height="200" fill="#FFFDE7" stroke="#F57F17" stroke-width="2" rx="5"/>
  <text x="110" y="125" font-size="13" font-weight="bold" text-anchor="middle" fill="#333">Model Parameters</text>
  <text x="30" y="150" font-size="11" fill="#333">• Vocab size: 20,000</text>
  <text x="30" y="170" font-size="11" fill="#333">• Embedding: 128</text>
  <text x="30" y="190" font-size="11" fill="#333">• Hidden dim: 256</text>
  <text x="30" y="210" font-size="11" fill="#333">• Output: 4 classes</text>
  <text x="30" y="230" font-size="11" fill="#333">• Optimizer: Adam</text>
  <text x="30" y="250" font-size="11" fill="#333">• Learning rate: 0.005</text>
  <text x="30" y="270" font-size="11" fill="#333">• Batch size: 128</text>
  <text x="30" y="290" font-size="11" fill="#333">• Device: MPS/CPU</text>
  
  <!-- Data Flow Info -->
  <rect x="600" y="100" width="180" height="160" fill="#F3E5F5" stroke="#7B1FA2" stroke-width="2" rx="5"/>
  <text x="690" y="125" font-size="13" font-weight="bold" text-anchor="middle" fill="#333">Key Features</text>
  <text x="610" y="150" font-size="11" fill="#333">✓ Variable length input</text>
  <text x="610" y="170" font-size="11" fill="#333">✓ Packed sequences</text>
  <text x="610" y="190" font-size="11" fill="#333">✓ LSTM (not basic RNN)</text>
  <text x="610" y="210" font-size="11" fill="#333">✓ Only last hidden used</text>
  <text x="610" y="230" font-size="11" fill="#333">✓ Multi-class output</text>
  <text x="610" y="250" font-size="11" fill="#333">✓ No activation at end</text>
  
  <!-- Arrow marker definition -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#333"/>
    </marker>
  </defs>
</svg>